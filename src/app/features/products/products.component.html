<div class="p-8 bg-gray-50 min-h-screen">
	<h2 class="text-3xl font-semibold text-gray-800 mb-6">Products Management</h2>

	<button (click)="openCreatePopup()" class="mb-4 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
		+ Add Product
	</button>

	<!-- Products Table -->
	<div class="overflow-x-auto">
		<table class="min-w-full bg-white rounded shadow-md">
			<thead class="bg-gray-100 text-left text-sm font-semibold text-gray-600">
				<tr>
					<th class="py-3 px-6">Image</th>
					<th class="py-3 px-6">Name</th>
					<th class="py-3 px-6">Price</th>
					<th class="py-3 px-6">Category</th>
					<th class="py-3 px-6">Actions</th>
				</tr>
			</thead>
			<tbody class="text-gray-700 text-sm divide-y divide-gray-200">
				<tr class="hover:bg-gray-50" *ngFor="let product of paginatedProducts">
					<td class="py-3 px-6">
						<img [src]="product.imageUrls[0]" alt="Product Image"
							class="h-12 w-12 object-cover cursor-pointer rounded"
							(click)="openImagePopup(product.imageUrls[0])" />
					</td>
					<td class="py-3 px-6">{{ product.name }}</td>
					<td class="py-3 px-6">{{ product.price }}</td>
					<td class="py-3 px-6">{{ product.category[0]?.name || '—' }}</td>
					<td class="py-3 px-6 space-x-2">
						<button class="text-blue-600 hover:underline">Edit</button>
						<button class="text-red-600 hover:underline">Delete</button>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
</div>

<!-- Image Popup -->
<div *ngIf="popupImageUrl" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50"
	(click)="closeImagePopup()">
	<div class="relative max-w-3xl max-h-[90vh] p-4 bg-white rounded shadow-lg">
		<img [src]="popupImageUrl" alt="Zoomed Image" class="max-w-full max-h-[80vh] mx-auto" />
		<button (click)="closeImagePopup()"
			class="absolute top-2 right-2 bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-800">✕</button>
	</div>
</div>

<!-- Create Product Modal -->
<div *ngIf="openCreateModal" class="fixed inset-0 z-50 bg-black bg-opacity-50 flex justify-center items-center">
	<div class="bg-white p-6 rounded-lg shadow-md w-full max-w-md">
		<h2 class="text-2xl font-bold mb-4 text-gray-800">Create Product</h2>

		<form [formGroup]="productForm" (ngSubmit)="submitProduct()" enctype="multipart/form-data" class="space-y-4">

			<!-- Category -->
			<div>
				<label class="block mb-1 font-medium">Category</label>
				<select formControlName="categoryId" class="w-full border rounded px-3 py-2">
					<option *ngFor="let cat of categories" [value]="cat._id">{{ cat.name }}</option>
				</select>
			</div>

			<!-- Subcategory -->
			<div>
				<label class="block mb-1 font-medium">Subcategory</label>
				<select formControlName="subcategoryId" class="w-full border rounded px-3 py-2">
					<option *ngFor="let sub of subcategories" [value]="sub._id">{{ sub.name }}</option>
				</select>
			</div>

			<!-- Name -->
			<div>
				<label class="block mb-1 font-medium">Name</label>
				<input type="text" formControlName="name" class="w-full border rounded px-3 py-2" />
			</div>

			<!-- Description -->
			<div>
				<label class="block mb-1 font-medium">Description</label>
				<textarea formControlName="description" class="w-full border rounded px-3 py-2"></textarea>
			</div>

			<!-- Price -->
			<div>
				<label class="block mb-1 font-medium">Price</label>
				<input type="number" formControlName="price" class="w-full border rounded px-3 py-2" />
			</div>

			<!-- Stock -->
			<div>
				<label class="block mb-1 font-medium">Stock</label>
				<input type="number" formControlName="stock" class="w-full border rounded px-3 py-2" />
			</div>

			<!-- Image Upload -->
			<div>
				<label class="block mb-1 font-medium">Images</label>
				<input type="file" (change)="onImageSelected($event)" multiple
					class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 rounded" />
			</div>

			<!-- Preview Selected Images -->
			<div *ngIf="selectedImages.length > 0" class="flex flex-wrap gap-2">
				<span *ngFor="let file of selectedImages" class="bg-gray-200 text-xs px-2 py-1 rounded">
					{{ file.name }}
				</span>
			</div>

			<!-- Is Active -->
			<label class="flex items-center space-x-2">
				<input type="checkbox" formControlName="isActive" />
				<span>Is Active</span>
			</label>

			<!-- Actions -->
			<div class="flex justify-end gap-3 pt-2">
				<button type="button" (click)="closeCreatePopup()" class="bg-gray-300 px-4 py-2 rounded">Cancel</button>
				<button type="submit" [disabled]="productForm.invalid"
					class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
					Submit
				</button>
			</div>
		</form>
	</div>
</div>
<app-pagination
  [currentPage]="currentPage"
  [itemsPerPage]="itemsPerPage"
  [totalItems]="products.length"
  (pageChange)="onPageChange($event)">
</app-pagination>